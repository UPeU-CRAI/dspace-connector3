<resource xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
          oid="196b0e1d-869f-491f-aad5-e7e95fc637a5" version="1">

    <!-- Nombre del recurso -->
    <name>DSpace</name>

    <!-- Referencia al conector -->
    <connectorRef oid="1527d183-d1af-42f5-b97c-f024299eadd4" version="1"/>

    <!-- Configuración del recurso -->
    <configuration>
        <!-- URL base del API DSpace -->
        <baseUrl>http://192.168.15.231:8080</baseUrl>
        <!-- Credenciales de autenticación -->
        <username>test@test.edu</username>
        <password>
            <encryptedData>
                <!-- Contraseña encriptada generada por MidPoint -->
                <cipherData>
                    <cipherValue>ENC(EncryptedPasswordHere)</cipherValue>
                </cipherData>
            </encryptedData>
        </password>
    </configuration>

    <!-- Configuración de esquema -->
    <schema>
        <generationConstraints>
            <!-- Define la clase de objeto a generar (por ejemplo: eperson) -->
            <generateObjectClass>eperson</generateObjectClass>
        </generationConstraints>
    </schema>

    <!-- Configuración de sincronización -->
    <synchronization>
        <objectSynchronization>
            <!-- Define el tipo de foco como un usuario en MidPoint -->
            <focusType>UserType</focusType>
            <!-- Plantilla de objeto referenciada para sincronización -->
            <objectTemplateRef oid="00000000-0000-0000-0000-000000000001" />

            <!-- Configuración de correlación -->
            <correlation>
                <expression>
                    <!-- Define la correlación basada en el email del EPerson -->
                    <value>eperson.email</value>
                </expression>
            </correlation>

            <!-- Configuración de confirmación -->
            <confirmation>
                <expression>
                    <!-- Validación de coincidencia entre foco y objeto del recurso -->
                    <script>return focus.email == resourceObject.email;</script>
                </expression>
            </confirmation>

            <!-- Reacciones ante situaciones específicas -->
            <reaction>
                <!-- Acción ante una situación de creación (ADD) -->
                <situation>ADD</situation>
                <action>
                    <focusModification>
                        <item>
                            <!-- Modificación del nombre del foco al crear -->
                            <path>name</path>
                            <value>New User</value>
                        </item>
                    </focusModification>
                </action>
            </reaction>
        </objectSynchronization>
    </synchronization>

    <!-- Configuración de capacidades -->
    <capabilities>
        <!-- Habilita las operaciones nativas de creación, actualización y eliminación -->
        <native>
            <create>true</create>
            <update>true</update>
            <delete>true</delete>
        </native>
        <!-- Habilita la ejecución de scripts en el recurso -->
        <scriptExecution>
            <enabled>true</enabled>
        </scriptExecution>
    </capabilities>
</resource>
